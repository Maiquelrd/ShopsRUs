<<<<<<< HEAD
=======
<div id="top"></div>



>>>>>>> a168b4518d2414002b67196c1b2efe4dc7544f6e
[![LinkedIn][linkedin-shield]][linkedin-url]



<<<<<<< HEAD
=======
<!-- Acerca del proyecto -->
>>>>>>> a168b4518d2414002b67196c1b2efe4dc7544f6e
##Acerca del proyecto

ShopsRUs es una tienda minorista existente. Quieren ofrecer descuentos a sus clientes en todas sus plataformas web / móviles. Requieren la construcción de un conjunto de API que brinden capacidades para calcular descuentos, generar los costos totales y generar las facturas para los clientes.

En la fábrica digital, actualmente tenemos una arquitectura de microservicios con servicios escritos en lenguajes y frameworks que soportan microservicios. Nos gustaría que desarrollaras un único servicio en nodejs que exponga varios endpoints REST (ver página siguiente) Puede utilizar la base de datos que desee (recomendamos utilizar Postgres) Deberá incluir un archivo README que contenga instrucciones para que podamos ejecutar la solución en nuestras máquinas.


<p align="right">(<a href="#top">Volver</a>)</p>



### Con que se trabajó



* [Node.js](https://nodejs.org/es/)
* [PostgreSQL](https://www.postgresql.org)

<p align="right">(<a href="#top">Volver</a>)</p>


## Inicialización

En esta sección explicaré como inicializar el proyecto.

### Prerequisitos

Nos aseguraremos de tener el npm en su ultima versión
  ```sh
  npm install npm@latest -g
  ```

### Instalacion

Para instalar la aplicación debermos realizar los siguientes pasos.

1. Clonaremos el repositorio
   ```sh
   git clone https://github.com/Maiquelrd/ShopsRUs
   ```
2. Instalaremos los paquetes que utiliza el proyecto
   ```sh
   npm install
   ```
3. En nuestra base de datos postgress pondremos los scripts puestos en el archivo sql/db.sql
   ```sh
   CREATE TABLE IF NOT EXISTS TiposProductos(
		TipoProductoID integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
		Nombre text,
		Descripcion text,
		FechaCreacion timestamp,
		Activo BOOLEAN
	);
CREATE TABLE IF NOT EXISTS Productos(
		ProductoID integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
		TipoProductoID INTEGER REFERENCES TiposProductos(TipoProductoID) ON DELETE CASCADE ON UPDATE CASCADE,
		Nombre text,
		Descripcion text,
		Precio decimal,
		FechaCreacion timestamp,
		Activo BOOLEAN
	);
CREATE TABLE IF NOT EXISTS TiposClientes(
		TipoClienteID integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
		Nombre text,
		Descripcion text,
		FechaCreacion timestamp,
		Activo BOOLEAN
	);
CREATE TABLE IF NOT EXISTS Clientes(
		ClienteID integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
		TipoClienteID INTEGER REFERENCES TiposClientes(TipoClienteID) ON DELETE CASCADE ON UPDATE CASCADE,
		Nombres text,
		Apellidos text,
		FechaNacimiento timestamp,
		FechaCreacion timestamp,
		Activo BOOLEAN
	);
CREATE TABLE IF NOT EXISTS Facturas(
		FacturaID integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
		ClienteID INTEGER REFERENCES Clientes(ClienteID) ON DELETE CASCADE ON UPDATE CASCADE,
		TotalCrudo decimal,
		TotalDescuento decimal,
		FechaCreacion timestamp,
		Activo BOOLEAN
	);
CREATE TABLE IF NOT EXISTS ProductosFacturas(
		ProductosFacturaID integer PRIMARY KEY GENERATED BY DEFAULT AS IDENTITY,
		FacturaID INTEGER REFERENCES Facturas(FacturaID) ON DELETE CASCADE ON UPDATE CASCADE,
		ProductoID INTEGER REFERENCES Productos(ProductoID) ON DELETE CASCADE ON UPDATE CASCADE,
		FechaCreacion timestamp,
		Activo BOOLEAN
	);
   ```
4. Pondremos los datos de la base de datos en el archivo .env
Ejemplo:
   ```js
   PORT = 3000
	DBSERVER = "ShopsRUs"
	DBUSER = "postgres"
	DBPASSWORD = "123"
	DBHOST = "localhost"
   ```

<p align="right">(<a href="#top">Volver</a>)</p>



<!-- USAGE EXAMPLES -->
## Uso

Para correr la aplicación ponemos el comando:

   ```js
   npm run build --ESTO ES SOLO LA PRIMERA VEZ
   npm run start
   ```



<p align="right">(<a href="#top">Volver</a>)</p>


## ENDPOINTS Y EJEMPLOS

Estos son los endpoints en el programa

**TipoProducto**:

* **api/tipoProductos **- GET - Obtiene una lista de todos los TiposProductos
* **api/tipoProductos/{id} **- GET - Obtiene el tipo producto con ese ID.
* **api/tipoProductos/create **- POST - Crea un tipoProducto con el body.
Ejemplo:
```json
{
    "nombre": "Electrodomestico",
    "descripcion": "Un articulo electronico para el hogar"
}
```
* **api/tipoProductos/{id} **- PUT - modifica un tipoProducto con el body.
Ejemplo:
```json
{
    "nombre": "Electrodomestico",
    "descripcion": "Un articulo electronico para el hogar"
}
```
* **api/tipoproductos/{id} **- DELETE - Elimina el tipo producto con ese ID.

<<<<<<< HEAD
**Producto**:

* **api/productos **- GET - Obtiene una lista de todos los productos
* **api/productos/{id} **- GET - Obtiene el tipo producto con ese ID.
=======
**Productos**:

* **api/productos **- GET - Obtiene una lista de todos los productos
* **api/productos/{id} **- GET - Obtiene el producto con ese ID.
>>>>>>> a168b4518d2414002b67196c1b2efe4dc7544f6e
* **api/productos/create **- POST - Crea un producto con el body.
Ejemplo:
```json
{
    "tipoproductoid": 2,
    "nombre": "Manzano",
    "descripcion": "pruebaDesc",
    "precio": 51.23
}
```
* **api/productos/{id} **- PUT - modifica un producto con el body.
Ejemplo:
```json
{
    "tipoproductoid": 2,
    "nombre": "Manzano",
    "descripcion": "pruebaDesc",
    "precio": 51.23
}
```
<<<<<<< HEAD
* **api/productos/{id} **- DELETE - Elimina el tipo producto con ese ID.



=======
* **api/productos/{id} **- DELETE - Elimina el producto con ese ID.

**Clientes**:

* **api/clientes **- GET - Obtiene una lista de todos los clientes
* **api/clientes/{id} **- GET - Obtiene el cliente con ese ID.
* **api/clientes/create **- POST - Crea un cliente con el body.
Ejemplo:
```json
{
    "tipoclienteid": 2,
    "nombres": "Daniel Marino",
    "apellidos": "Marte Sorano",
    "fechanacimiento": "2002-06-03T23:47:03.390Z"
}
```
* **api/clientes/{id} **- PUT - modifica un cliente con el body.
Ejemplo:
```json
{
    "tipoclienteid": 2,
    "nombres": "Daniel Marino",
    "apellidos": "Marte Sorano",
    "fechanacimiento": "2002-06-03T23:47:03.390Z"
}
```
* **api/clientes/{id} **- DELETE - Elimina el cliente con ese ID.

**Facturas**:

* **api/facturas **- GET - Obtiene una lista de todas las facturas
* **api/facturas/{id} **- GET - Obtiene la factura con ese ID.
* **api/facturas/create **- POST - Crea una factura con el body.
Ejemplo:
```json
{
    "clienteid": 1,
    "productos": [1,2]
}
```
* **api/facturas/{id} **- DELETE - Elimina la factura con ese ID.

**Descuentos**:

* **api/descuentos **- GET - Obtiene una lista de todos los descuentos
* **api/descuentos/{id} **- GET - Obtiene el descuento con ese ID.
* **api/descuentos/create **- POST - Crea un descuento con el body.
Ejemplo:
```json
{
    "nombre":  "30% por fidelidad",
    "tipo": "Porcentual",
    "valor": 30,
    "reglas": [
        {
            "id": 6,
            "criterio": ">=|2"
        }
    ]
}
```

* **api/descuentos/{id} **- PUT - modifica un descuento con el body.
Ejemplo:
```json
{
    "nombre":  "30% por fidelidad",
    "tipo": "Porcentual",
    "valor": 30
}
```
* **api/descuentos/{id} **- DELETE - Elimina el descuento con ese ID.

* **api/descuentos/{id}/addrules **- POST - Agrega reglas al descuento de ese id desde el body.
Ejemplo:
```json
{
    "reglas": [
        {
            "id": 6,
            "criterio": ">=|2"
        },
		{
            "id": 5,
            "criterio": ">=|21"
        }
    ]
}
```

* **api/descuentos/{id}/removerules **- POST - elimina reglas al descuento de ese id desde el body. (OJO, ESTOS IDs no son de las reglas, son el id que le pertenece a la tabla regladescuento)
Ejemplo:
```json
{
    "reglas": [
        {
            "id": 1
        },
		{
            "id": 2
        }
    ]
}
```
>>>>>>> a168b4518d2414002b67196c1b2efe4dc7544f6e

<p align="right">(<a href="#top">Volver</a>)</p>


## Contacto

Mauricio Mojica - [@sirmaiquis](https://www.instagram.com/sirmaiquis/) - maiquel.mojica@gmail.com

Link del proyecto: [https://github.com/Maiquelrd/ShopsRUs)

<p align="right">(<a href="#top">Volver</a>)</p>



[linkedin-shield]: https://img.shields.io/badge/-LinkedIn-black.svg?style=for-the-badge&logo=linkedin&colorB=555
[linkedin-url]: https://www.linkedin.com/in/mauriciomojica/
[product-screenshot]: images/screenshot.png
